'use babel';
/* @flow */

/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

var _require = require('../lib/editor-utils');

var buildLineRangesWithOffsets = _require.buildLineRangesWithOffsets;

describe('editor-utils', function () {

  describe('buildLineRangesWithOffsets()', function () {
    it('returns adjusted regions and screen lines when offsets are in the middle of the lines', function () {
      var _buildLineRangesWithOffsets = buildLineRangesWithOffsets([1, 2, 3, 4], { 2: 2 }, 0, 4, function () {
        return 0;
      });

      var regions = _buildLineRangesWithOffsets.regions;
      var screenLines = _buildLineRangesWithOffsets.screenLines;

      expect(regions).toEqual([{ bufferRows: 1, screenRows: 1 }, { bufferRows: 1, screenRows: 3 }, { bufferRows: 2, screenRows: 2 }]);
      expect(screenLines).toEqual([1, 2, 0, 0, 3, 4]);
    });

    it('returns adjusted regions and screen lines when an offset is set to the second line', function () {
      var _buildLineRangesWithOffsets2 = buildLineRangesWithOffsets([1, 2, 3, 4], { 1: 2 }, 0, 4, function () {
        return 0;
      });

      var regions = _buildLineRangesWithOffsets2.regions;
      var screenLines = _buildLineRangesWithOffsets2.screenLines;

      expect(regions).toEqual([{ bufferRows: 1, screenRows: 3 }, { bufferRows: 3, screenRows: 3 }]);
      expect(screenLines).toEqual([1, 0, 0, 2, 3, 4]);
    });

    it('returns adjusted regions and screen lines when an offset is set to the first line', function () {
      var _buildLineRangesWithOffsets3 = buildLineRangesWithOffsets([1, 2, 3, 4], { 0: 2 }, 0, 4, function () {
        return 0;
      });

      var regions = _buildLineRangesWithOffsets3.regions;
      var screenLines = _buildLineRangesWithOffsets3.screenLines;

      expect(regions).toEqual([{ bufferRows: 1, screenRows: 3 }, { bufferRows: 3, screenRows: 3 }]);
      expect(screenLines).toEqual([0, 0, 1, 2, 3, 4]);
    });

    it('returns the same regions and screen lines when start row is after all offsets', function () {
      var _buildLineRangesWithOffsets4 = buildLineRangesWithOffsets([1, 2, 3, 4], { 0: 2 }, 3, 7, function () {
        return 0;
      });

      var regions = _buildLineRangesWithOffsets4.regions;
      var screenLines = _buildLineRangesWithOffsets4.screenLines;

      expect(regions).toEqual([{ bufferRows: 4, screenRows: 4 }]);
      expect(screenLines).toEqual([1, 2, 3, 4]);
    });

    it('returns the same regions and screen lines when end row is before all offsets', function () {
      var _buildLineRangesWithOffsets5 = buildLineRangesWithOffsets([1, 2, 3, 4], { 9: 2 }, 3, 7, function () {
        return 0;
      });

      var regions = _buildLineRangesWithOffsets5.regions;
      var screenLines = _buildLineRangesWithOffsets5.screenLines;

      expect(regions).toEqual([{ bufferRows: 4, screenRows: 4 }]);
      expect(screenLines).toEqual([1, 2, 3, 4]);
    });

    it('returns adjusted regions and screen lines when start row is > 0', function () {
      var _buildLineRangesWithOffsets6 = buildLineRangesWithOffsets([1, 2, 3, 4], { 5: 2 }, 3, 7, function () {
        return 0;
      });

      var regions = _buildLineRangesWithOffsets6.regions;
      var screenLines = _buildLineRangesWithOffsets6.screenLines;

      expect(regions).toEqual([{ bufferRows: 1, screenRows: 1 }, { bufferRows: 1, screenRows: 3 }, { bufferRows: 2, screenRows: 2 }]);
      expect(screenLines).toEqual([1, 2, 0, 0, 3, 4]);
    });

    it('returns adjusted regions and screen lines when start row equals the first offset', function () {
      var _buildLineRangesWithOffsets7 = buildLineRangesWithOffsets([1, 2, 3, 4], { 3: 1, 8: 1 }, 3, 7, function () {
        return 0;
      });

      var regions = _buildLineRangesWithOffsets7.regions;
      var screenLines = _buildLineRangesWithOffsets7.screenLines;

      expect(regions).toEqual([{ bufferRows: 1, screenRows: 2 }, { bufferRows: 3, screenRows: 3 }]);
      expect(screenLines).toEqual([0, 1, 2, 3, 4]);
    });

    it('returns adjusted regions and screen lines the last offset is just before the last line requested', function () {
      var _buildLineRangesWithOffsets8 = buildLineRangesWithOffsets([1, 2, 3, 4], { 1: 1, 6: 1 }, 3, 7, function () {
        return 0;
      });

      var regions = _buildLineRangesWithOffsets8.regions;
      var screenLines = _buildLineRangesWithOffsets8.screenLines;

      expect(regions).toEqual([{ bufferRows: 2, screenRows: 2 }, { bufferRows: 1, screenRows: 2 }, { bufferRows: 1, screenRows: 1 }]);
      expect(screenLines).toEqual([1, 2, 3, 0, 4]);
    });

    it('returns adjusted regions and screen lines the last offset is the last line requested', function () {
      var _buildLineRangesWithOffsets9 = buildLineRangesWithOffsets([1, 2, 3, 4], { 1: 1, 7: 1 }, 3, 7, function () {
        return 0;
      });

      var regions = _buildLineRangesWithOffsets9.regions;
      var screenLines = _buildLineRangesWithOffsets9.screenLines;

      expect(regions).toEqual([{ bufferRows: 4, screenRows: 4 }]);
      expect(screenLines).toEqual([1, 2, 3, 4]);

      var _buildLineRangesWithOffsets10 = buildLineRangesWithOffsets([5, 6, 7, 8], { 1: 1, 7: 1 }, 7, 11, function () {
        return 0;
      });

      var followingRegions = _buildLineRangesWithOffsets10.regions;
      var followingScreenLines = _buildLineRangesWithOffsets10.screenLines;

      expect(followingRegions).toEqual([{ bufferRows: 1, screenRows: 2 }, { bufferRows: 3, screenRows: 3 }]);
      expect(followingScreenLines).toEqual([0, 5, 6, 7, 8]);
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbmRyZXdqb25lcy8uYXRvbS9wYWNrYWdlcy9udWNsaWRlLWRpZmYtdmlldy9zcGVjL2VkaXRvci11dGlscy1zcGVjLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFdBQVcsQ0FBQzs7Ozs7Ozs7Ozs7ZUFXdUIsT0FBTyxDQUFDLHFCQUFxQixDQUFDOztJQUE1RCwwQkFBMEIsWUFBMUIsMEJBQTBCOztBQUUvQixRQUFRLENBQUMsY0FBYyxFQUFFLFlBQU07O0FBRTdCLFVBQVEsQ0FBQyw4QkFBOEIsRUFBRSxZQUFNO0FBQzdDLE1BQUUsQ0FBQyx1RkFBdUYsRUFBRSxZQUFNO3dDQUNuRSwwQkFBMEIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUU7ZUFBTSxDQUFDO09BQUEsQ0FBQzs7VUFBdkYsT0FBTywrQkFBUCxPQUFPO1VBQUUsV0FBVywrQkFBWCxXQUFXOztBQUN6QixZQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQ3RCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLEVBQzlCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLEVBQzlCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLENBQy9CLENBQUMsQ0FBQztBQUNILFlBQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDakQsQ0FBQyxDQUFDOztBQUVILE1BQUUsQ0FBQyxvRkFBb0YsRUFBRSxZQUFNO3lDQUNoRSwwQkFBMEIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUU7ZUFBTSxDQUFDO09BQUEsQ0FBQzs7VUFBdkYsT0FBTyxnQ0FBUCxPQUFPO1VBQUUsV0FBVyxnQ0FBWCxXQUFXOztBQUN6QixZQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQ3RCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLEVBQzlCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLENBQy9CLENBQUMsQ0FBQztBQUNILFlBQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDakQsQ0FBQyxDQUFDOztBQUVILE1BQUUsQ0FBQyxtRkFBbUYsRUFBRSxZQUFNO3lDQUMvRCwwQkFBMEIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUU7ZUFBTSxDQUFDO09BQUEsQ0FBQzs7VUFBdkYsT0FBTyxnQ0FBUCxPQUFPO1VBQUUsV0FBVyxnQ0FBWCxXQUFXOztBQUN6QixZQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQ3RCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLEVBQzlCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLENBQy9CLENBQUMsQ0FBQztBQUNILFlBQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDakQsQ0FBQyxDQUFDOztBQUVILE1BQUUsQ0FBQywrRUFBK0UsRUFBRSxZQUFNO3lDQUMzRCwwQkFBMEIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUU7ZUFBTSxDQUFDO09BQUEsQ0FBQzs7VUFBdkYsT0FBTyxnQ0FBUCxPQUFPO1VBQUUsV0FBVyxnQ0FBWCxXQUFXOztBQUN6QixZQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQ3RCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLENBQy9CLENBQUMsQ0FBQztBQUNILFlBQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQzNDLENBQUMsQ0FBQzs7QUFFSCxNQUFFLENBQUMsOEVBQThFLEVBQUUsWUFBTTt5Q0FDMUQsMEJBQTBCLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFO2VBQU0sQ0FBQztPQUFBLENBQUM7O1VBQXZGLE9BQU8sZ0NBQVAsT0FBTztVQUFFLFdBQVcsZ0NBQVgsV0FBVzs7QUFDekIsWUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUN0QixFQUFDLFVBQVUsRUFBRSxDQUFDLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBQyxDQUMvQixDQUFDLENBQUM7QUFDSCxZQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUMzQyxDQUFDLENBQUM7O0FBRUgsTUFBRSxDQUFDLGlFQUFpRSxFQUFFLFlBQU07eUNBQzdDLDBCQUEwQixDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRTtlQUFNLENBQUM7T0FBQSxDQUFDOztVQUF2RixPQUFPLGdDQUFQLE9BQU87VUFBRSxXQUFXLGdDQUFYLFdBQVc7O0FBQ3pCLFlBQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FDdEIsRUFBQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUMsRUFDOUIsRUFBQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUMsRUFDOUIsRUFBQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUMsQ0FDL0IsQ0FBQyxDQUFDO0FBQ0gsWUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUNqRCxDQUFDLENBQUM7O0FBRUgsTUFBRSxDQUFDLGtGQUFrRixFQUFFLFlBQU07eUNBQzlELDBCQUEwQixDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFO2VBQU0sQ0FBQztPQUFBLENBQUM7O1VBQTdGLE9BQU8sZ0NBQVAsT0FBTztVQUFFLFdBQVcsZ0NBQVgsV0FBVzs7QUFDekIsWUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUN0QixFQUFDLFVBQVUsRUFBRSxDQUFDLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBQyxFQUM5QixFQUFDLFVBQVUsRUFBRSxDQUFDLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBQyxDQUMvQixDQUFDLENBQUM7QUFDSCxZQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDOUMsQ0FBQyxDQUFDOztBQUVILE1BQUUsQ0FBQyxrR0FBa0csRUFBRSxZQUFNO3lDQUM5RSwwQkFBMEIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRTtlQUFNLENBQUM7T0FBQSxDQUFDOztVQUE3RixPQUFPLGdDQUFQLE9BQU87VUFBRSxXQUFXLGdDQUFYLFdBQVc7O0FBQ3pCLFlBQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FDdEIsRUFBQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUMsRUFDOUIsRUFBQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUMsRUFDOUIsRUFBQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUMsQ0FDL0IsQ0FBQyxDQUFDO0FBQ0gsWUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQzlDLENBQUMsQ0FBQzs7QUFFSCxNQUFFLENBQUMsc0ZBQXNGLEVBQUUsWUFBTTt5Q0FDbEUsMEJBQTBCLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUU7ZUFBTSxDQUFDO09BQUEsQ0FBQzs7VUFBN0YsT0FBTyxnQ0FBUCxPQUFPO1VBQUUsV0FBVyxnQ0FBWCxXQUFXOztBQUN6QixZQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQ3RCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLENBQy9CLENBQUMsQ0FBQztBQUNILFlBQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDOzswQ0FHdEMsMEJBQTBCLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUU7ZUFBTSxDQUFDO09BQUEsQ0FBQzs7VUFENUQsZ0JBQWdCLGlDQUF6QixPQUFPO1VBQWlDLG9CQUFvQixpQ0FBakMsV0FBVzs7QUFFM0MsWUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUMsT0FBTyxDQUFDLENBQy9CLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLEVBQzlCLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFDLENBQy9CLENBQUMsQ0FBQztBQUNILFlBQU0sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3ZELENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiIvVXNlcnMvYW5kcmV3am9uZXMvLmF0b20vcGFja2FnZXMvbnVjbGlkZS1kaWZmLXZpZXcvc3BlYy9lZGl0b3ItdXRpbHMtc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbnZhciB7YnVpbGRMaW5lUmFuZ2VzV2l0aE9mZnNldHN9ID0gcmVxdWlyZSgnLi4vbGliL2VkaXRvci11dGlscycpO1xuXG5kZXNjcmliZSgnZWRpdG9yLXV0aWxzJywgKCkgPT4ge1xuXG4gIGRlc2NyaWJlKCdidWlsZExpbmVSYW5nZXNXaXRoT2Zmc2V0cygpJywgKCkgPT4ge1xuICAgIGl0KCdyZXR1cm5zIGFkanVzdGVkIHJlZ2lvbnMgYW5kIHNjcmVlbiBsaW5lcyB3aGVuIG9mZnNldHMgYXJlIGluIHRoZSBtaWRkbGUgb2YgdGhlIGxpbmVzJywgKCkgPT4ge1xuICAgICAgdmFyIHtyZWdpb25zLCBzY3JlZW5MaW5lc30gPSBidWlsZExpbmVSYW5nZXNXaXRoT2Zmc2V0cyhbMSwgMiwgMywgNF0sIHsyOiAyfSwgMCwgNCwgKCkgPT4gMCk7XG4gICAgICBleHBlY3QocmVnaW9ucykudG9FcXVhbChbXG4gICAgICAgIHtidWZmZXJSb3dzOiAxLCBzY3JlZW5Sb3dzOiAxfSxcbiAgICAgICAge2J1ZmZlclJvd3M6IDEsIHNjcmVlblJvd3M6IDN9LFxuICAgICAgICB7YnVmZmVyUm93czogMiwgc2NyZWVuUm93czogMn0sXG4gICAgICBdKTtcbiAgICAgIGV4cGVjdChzY3JlZW5MaW5lcykudG9FcXVhbChbMSwgMiwgMCwgMCwgMywgNF0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3JldHVybnMgYWRqdXN0ZWQgcmVnaW9ucyBhbmQgc2NyZWVuIGxpbmVzIHdoZW4gYW4gb2Zmc2V0IGlzIHNldCB0byB0aGUgc2Vjb25kIGxpbmUnLCAoKSA9PiB7XG4gICAgICB2YXIge3JlZ2lvbnMsIHNjcmVlbkxpbmVzfSA9IGJ1aWxkTGluZVJhbmdlc1dpdGhPZmZzZXRzKFsxLCAyLCAzLCA0XSwgezE6IDJ9LCAwLCA0LCAoKSA9PiAwKTtcbiAgICAgIGV4cGVjdChyZWdpb25zKS50b0VxdWFsKFtcbiAgICAgICAge2J1ZmZlclJvd3M6IDEsIHNjcmVlblJvd3M6IDN9LFxuICAgICAgICB7YnVmZmVyUm93czogMywgc2NyZWVuUm93czogM30sXG4gICAgICBdKTtcbiAgICAgIGV4cGVjdChzY3JlZW5MaW5lcykudG9FcXVhbChbMSwgMCwgMCwgMiwgMywgNF0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3JldHVybnMgYWRqdXN0ZWQgcmVnaW9ucyBhbmQgc2NyZWVuIGxpbmVzIHdoZW4gYW4gb2Zmc2V0IGlzIHNldCB0byB0aGUgZmlyc3QgbGluZScsICgpID0+IHtcbiAgICAgIHZhciB7cmVnaW9ucywgc2NyZWVuTGluZXN9ID0gYnVpbGRMaW5lUmFuZ2VzV2l0aE9mZnNldHMoWzEsIDIsIDMsIDRdLCB7MDogMn0sIDAsIDQsICgpID0+IDApO1xuICAgICAgZXhwZWN0KHJlZ2lvbnMpLnRvRXF1YWwoW1xuICAgICAgICB7YnVmZmVyUm93czogMSwgc2NyZWVuUm93czogM30sXG4gICAgICAgIHtidWZmZXJSb3dzOiAzLCBzY3JlZW5Sb3dzOiAzfSxcbiAgICAgIF0pO1xuICAgICAgZXhwZWN0KHNjcmVlbkxpbmVzKS50b0VxdWFsKFswLCAwLCAxLCAyLCAzLCA0XSk7XG4gICAgfSk7XG5cbiAgICBpdCgncmV0dXJucyB0aGUgc2FtZSByZWdpb25zIGFuZCBzY3JlZW4gbGluZXMgd2hlbiBzdGFydCByb3cgaXMgYWZ0ZXIgYWxsIG9mZnNldHMnLCAoKSA9PiB7XG4gICAgICB2YXIge3JlZ2lvbnMsIHNjcmVlbkxpbmVzfSA9IGJ1aWxkTGluZVJhbmdlc1dpdGhPZmZzZXRzKFsxLCAyLCAzLCA0XSwgezA6IDJ9LCAzLCA3LCAoKSA9PiAwKTtcbiAgICAgIGV4cGVjdChyZWdpb25zKS50b0VxdWFsKFtcbiAgICAgICAge2J1ZmZlclJvd3M6IDQsIHNjcmVlblJvd3M6IDR9LFxuICAgICAgXSk7XG4gICAgICBleHBlY3Qoc2NyZWVuTGluZXMpLnRvRXF1YWwoWzEsIDIsIDMsIDRdKTtcbiAgICB9KTtcblxuICAgIGl0KCdyZXR1cm5zIHRoZSBzYW1lIHJlZ2lvbnMgYW5kIHNjcmVlbiBsaW5lcyB3aGVuIGVuZCByb3cgaXMgYmVmb3JlIGFsbCBvZmZzZXRzJywgKCkgPT4ge1xuICAgICAgdmFyIHtyZWdpb25zLCBzY3JlZW5MaW5lc30gPSBidWlsZExpbmVSYW5nZXNXaXRoT2Zmc2V0cyhbMSwgMiwgMywgNF0sIHs5OiAyfSwgMywgNywgKCkgPT4gMCk7XG4gICAgICBleHBlY3QocmVnaW9ucykudG9FcXVhbChbXG4gICAgICAgIHtidWZmZXJSb3dzOiA0LCBzY3JlZW5Sb3dzOiA0fSxcbiAgICAgIF0pO1xuICAgICAgZXhwZWN0KHNjcmVlbkxpbmVzKS50b0VxdWFsKFsxLCAyLCAzLCA0XSk7XG4gICAgfSk7XG5cbiAgICBpdCgncmV0dXJucyBhZGp1c3RlZCByZWdpb25zIGFuZCBzY3JlZW4gbGluZXMgd2hlbiBzdGFydCByb3cgaXMgPiAwJywgKCkgPT4ge1xuICAgICAgdmFyIHtyZWdpb25zLCBzY3JlZW5MaW5lc30gPSBidWlsZExpbmVSYW5nZXNXaXRoT2Zmc2V0cyhbMSwgMiwgMywgNF0sIHs1OiAyfSwgMywgNywgKCkgPT4gMCk7XG4gICAgICBleHBlY3QocmVnaW9ucykudG9FcXVhbChbXG4gICAgICAgIHtidWZmZXJSb3dzOiAxLCBzY3JlZW5Sb3dzOiAxfSxcbiAgICAgICAge2J1ZmZlclJvd3M6IDEsIHNjcmVlblJvd3M6IDN9LFxuICAgICAgICB7YnVmZmVyUm93czogMiwgc2NyZWVuUm93czogMn0sXG4gICAgICBdKTtcbiAgICAgIGV4cGVjdChzY3JlZW5MaW5lcykudG9FcXVhbChbMSwgMiwgMCwgMCwgMywgNF0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3JldHVybnMgYWRqdXN0ZWQgcmVnaW9ucyBhbmQgc2NyZWVuIGxpbmVzIHdoZW4gc3RhcnQgcm93IGVxdWFscyB0aGUgZmlyc3Qgb2Zmc2V0JywgKCkgPT4ge1xuICAgICAgdmFyIHtyZWdpb25zLCBzY3JlZW5MaW5lc30gPSBidWlsZExpbmVSYW5nZXNXaXRoT2Zmc2V0cyhbMSwgMiwgMywgNF0sIHszOiAxLCA4OiAxfSwgMywgNywgKCkgPT4gMCk7XG4gICAgICBleHBlY3QocmVnaW9ucykudG9FcXVhbChbXG4gICAgICAgIHtidWZmZXJSb3dzOiAxLCBzY3JlZW5Sb3dzOiAyfSxcbiAgICAgICAge2J1ZmZlclJvd3M6IDMsIHNjcmVlblJvd3M6IDN9LFxuICAgICAgXSk7XG4gICAgICBleHBlY3Qoc2NyZWVuTGluZXMpLnRvRXF1YWwoWzAsIDEsIDIsIDMsIDRdKTtcbiAgICB9KTtcblxuICAgIGl0KCdyZXR1cm5zIGFkanVzdGVkIHJlZ2lvbnMgYW5kIHNjcmVlbiBsaW5lcyB0aGUgbGFzdCBvZmZzZXQgaXMganVzdCBiZWZvcmUgdGhlIGxhc3QgbGluZSByZXF1ZXN0ZWQnLCAoKSA9PiB7XG4gICAgICB2YXIge3JlZ2lvbnMsIHNjcmVlbkxpbmVzfSA9IGJ1aWxkTGluZVJhbmdlc1dpdGhPZmZzZXRzKFsxLCAyLCAzLCA0XSwgezE6IDEsIDY6IDF9LCAzLCA3LCAoKSA9PiAwKTtcbiAgICAgIGV4cGVjdChyZWdpb25zKS50b0VxdWFsKFtcbiAgICAgICAge2J1ZmZlclJvd3M6IDIsIHNjcmVlblJvd3M6IDJ9LFxuICAgICAgICB7YnVmZmVyUm93czogMSwgc2NyZWVuUm93czogMn0sXG4gICAgICAgIHtidWZmZXJSb3dzOiAxLCBzY3JlZW5Sb3dzOiAxfSxcbiAgICAgIF0pO1xuICAgICAgZXhwZWN0KHNjcmVlbkxpbmVzKS50b0VxdWFsKFsxLCAyLCAzLCAwLCA0XSk7XG4gICAgfSk7XG5cbiAgICBpdCgncmV0dXJucyBhZGp1c3RlZCByZWdpb25zIGFuZCBzY3JlZW4gbGluZXMgdGhlIGxhc3Qgb2Zmc2V0IGlzIHRoZSBsYXN0IGxpbmUgcmVxdWVzdGVkJywgKCkgPT4ge1xuICAgICAgdmFyIHtyZWdpb25zLCBzY3JlZW5MaW5lc30gPSBidWlsZExpbmVSYW5nZXNXaXRoT2Zmc2V0cyhbMSwgMiwgMywgNF0sIHsxOiAxLCA3OiAxfSwgMywgNywgKCkgPT4gMCk7XG4gICAgICBleHBlY3QocmVnaW9ucykudG9FcXVhbChbXG4gICAgICAgIHtidWZmZXJSb3dzOiA0LCBzY3JlZW5Sb3dzOiA0fSxcbiAgICAgIF0pO1xuICAgICAgZXhwZWN0KHNjcmVlbkxpbmVzKS50b0VxdWFsKFsxLCAyLCAzLCA0XSk7XG5cbiAgICAgIHZhciB7cmVnaW9uczogZm9sbG93aW5nUmVnaW9ucywgc2NyZWVuTGluZXM6IGZvbGxvd2luZ1NjcmVlbkxpbmVzfSA9XG4gICAgICAgICAgYnVpbGRMaW5lUmFuZ2VzV2l0aE9mZnNldHMoWzUsIDYsIDcsIDhdLCB7MTogMSwgNzogMX0sIDcsIDExLCAoKSA9PiAwKTtcbiAgICAgIGV4cGVjdChmb2xsb3dpbmdSZWdpb25zKS50b0VxdWFsKFtcbiAgICAgICAge2J1ZmZlclJvd3M6IDEsIHNjcmVlblJvd3M6IDJ9LFxuICAgICAgICB7YnVmZmVyUm93czogMywgc2NyZWVuUm93czogM30sXG4gICAgICBdKTtcbiAgICAgIGV4cGVjdChmb2xsb3dpbmdTY3JlZW5MaW5lcykudG9FcXVhbChbMCwgNSwgNiwgNywgOF0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19