var vm = require('vm');
var fs = require('fs');
global.stack = function () {
    console.error(new Error().stack);
};
function makeTsGlobal(typescriptServices) {
    var sandbox = {
        ts: {},
        console: console,
        stack: global.stack,
        require: require,
        module: module,
        process: process
    };
    vm.createContext(sandbox);
    if (typescriptServices) {
        vm.runInContext(fs.readFileSync(typescriptServices).toString(), sandbox);
    } else {
        vm.runInContext(fs.readFileSync(require.resolve('ntypescript')).toString(), sandbox);
    }
    global.ts = sandbox.ts;
}
exports.makeTsGlobal = makeTsGlobal;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbmRyZXdqb25lcy8uYXRvbS9wYWNrYWdlcy9hdG9tLXR5cGVzY3JpcHQvZGlzdC90eXBlc2NyaXB0L21ha2VUeXBlU2NyaXB0R2xvYmFsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQUksRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN2QixJQUFJLEVBQUUsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDdkIsTUFBTSxDQUFDLEtBQUssR0FBRyxZQUFZO0FBQ3ZCLFdBQU8sQ0FBQyxLQUFLLENBQUMsQUFBQyxJQUFJLEtBQUssRUFBRSxDQUFFLEtBQUssQ0FBQyxDQUFDO0NBQ3RDLENBQUM7QUFDRixTQUFTLFlBQVksQ0FBQyxrQkFBa0IsRUFBRTtBQUN0QyxRQUFJLE9BQU8sR0FBRztBQUNWLFVBQUUsRUFBRSxFQUFFO0FBQ04sZUFBTyxFQUFFLE9BQU87QUFDaEIsYUFBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLO0FBQ25CLGVBQU8sRUFBRSxPQUFPO0FBQ2hCLGNBQU0sRUFBRSxNQUFNO0FBQ2QsZUFBTyxFQUFFLE9BQU87S0FDbkIsQ0FBQztBQUNGLE1BQUUsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDMUIsUUFBSSxrQkFBa0IsRUFBRTtBQUNwQixVQUFFLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxPQUFPLENBQUMsQ0FBQztLQUM1RSxNQUNJO0FBQ0QsVUFBRSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxPQUFPLENBQUMsQ0FBQztLQUN4RjtBQUNELFVBQU0sQ0FBQyxFQUFFLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQztDQUMxQjtBQUNELE9BQU8sQ0FBQyxZQUFZLEdBQUcsWUFBWSxDQUFDIiwiZmlsZSI6Ii9Vc2Vycy9hbmRyZXdqb25lcy8uYXRvbS9wYWNrYWdlcy9hdG9tLXR5cGVzY3JpcHQvZGlzdC90eXBlc2NyaXB0L21ha2VUeXBlU2NyaXB0R2xvYmFsLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHZtID0gcmVxdWlyZSgndm0nKTtcbnZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5nbG9iYWwuc3RhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29uc29sZS5lcnJvcigobmV3IEVycm9yKCkpLnN0YWNrKTtcbn07XG5mdW5jdGlvbiBtYWtlVHNHbG9iYWwodHlwZXNjcmlwdFNlcnZpY2VzKSB7XG4gICAgdmFyIHNhbmRib3ggPSB7XG4gICAgICAgIHRzOiB7fSxcbiAgICAgICAgY29uc29sZTogY29uc29sZSxcbiAgICAgICAgc3RhY2s6IGdsb2JhbC5zdGFjayxcbiAgICAgICAgcmVxdWlyZTogcmVxdWlyZSxcbiAgICAgICAgbW9kdWxlOiBtb2R1bGUsXG4gICAgICAgIHByb2Nlc3M6IHByb2Nlc3NcbiAgICB9O1xuICAgIHZtLmNyZWF0ZUNvbnRleHQoc2FuZGJveCk7XG4gICAgaWYgKHR5cGVzY3JpcHRTZXJ2aWNlcykge1xuICAgICAgICB2bS5ydW5JbkNvbnRleHQoZnMucmVhZEZpbGVTeW5jKHR5cGVzY3JpcHRTZXJ2aWNlcykudG9TdHJpbmcoKSwgc2FuZGJveCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2bS5ydW5JbkNvbnRleHQoZnMucmVhZEZpbGVTeW5jKHJlcXVpcmUucmVzb2x2ZSgnbnR5cGVzY3JpcHQnKSkudG9TdHJpbmcoKSwgc2FuZGJveCk7XG4gICAgfVxuICAgIGdsb2JhbC50cyA9IHNhbmRib3gudHM7XG59XG5leHBvcnRzLm1ha2VUc0dsb2JhbCA9IG1ha2VUc0dsb2JhbDtcbiJdfQ==