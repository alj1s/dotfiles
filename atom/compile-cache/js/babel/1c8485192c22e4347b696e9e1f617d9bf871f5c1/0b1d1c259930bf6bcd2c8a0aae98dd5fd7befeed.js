'use babel';
/* @flow */

/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

var _require = require('atom');

var Range = _require.Range;

/**
 * Returns the text and range for the word that contains the given position.
 */
function getWordTextAndRange(textEditor, position, wordRegExp) {
  if (!wordRegExp) {
    wordRegExp = textEditor.getLastCursor().wordRegExp();
  }

  var textAndRange = { text: '', range: new Range(position, position) };
  var buffer = textEditor.getBuffer();
  buffer.scanInRange(wordRegExp, buffer.rangeForRow(position.row), function (data) {
    if (data.range.containsPoint(position)) {
      textAndRange = {
        text: data.matchText,
        range: data.range
      };
      data.stop();
    } else if (data.range.end.column > position.column) {
      // Stop the scan if the scanner has passed our position.
      data.stop();
    }
  });

  return textAndRange;
}

module.exports = getWordTextAndRange;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbmRyZXdqb25lcy8uYXRvbS9wYWNrYWdlcy9oeXBlcmNsaWNrL2xpYi9nZXQtd29yZC10ZXh0LWFuZC1yYW5nZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxXQUFXLENBQUM7Ozs7Ozs7Ozs7O2VBV0UsT0FBTyxDQUFDLE1BQU0sQ0FBQzs7SUFBeEIsS0FBSyxZQUFMLEtBQUs7Ozs7O0FBS1YsU0FBUyxtQkFBbUIsQ0FDeEIsVUFBc0IsRUFDdEIsUUFBb0IsRUFDcEIsVUFBb0IsRUFBZ0M7QUFDdEQsTUFBSSxDQUFDLFVBQVUsRUFBRTtBQUNmLGNBQVUsR0FBRyxVQUFVLENBQUMsYUFBYSxFQUFFLENBQUMsVUFBVSxFQUFFLENBQUM7R0FDdEQ7O0FBRUQsTUFBSSxZQUFZLEdBQUcsRUFBQyxJQUFJLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLEtBQUssQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLEVBQUMsQ0FBQztBQUNwRSxNQUFJLE1BQU0sR0FBRyxVQUFVLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDcEMsUUFBTSxDQUFDLFdBQVcsQ0FBQyxVQUFVLEVBQUUsTUFBTSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUUsVUFBQSxJQUFJLEVBQUk7QUFDdkUsUUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsRUFBRTtBQUN0QyxrQkFBWSxHQUFHO0FBQ2IsWUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTO0FBQ3BCLGFBQUssRUFBRSxJQUFJLENBQUMsS0FBSztPQUNsQixDQUFDO0FBQ0YsVUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0tBQ2IsTUFBTSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUMsTUFBTSxFQUFFOztBQUVsRCxVQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7S0FDYjtHQUNGLENBQUMsQ0FBQzs7QUFFSCxTQUFPLFlBQVksQ0FBQztDQUNyQjs7QUFFRCxNQUFNLENBQUMsT0FBTyxHQUFHLG1CQUFtQixDQUFDIiwiZmlsZSI6Ii9Vc2Vycy9hbmRyZXdqb25lcy8uYXRvbS9wYWNrYWdlcy9oeXBlcmNsaWNrL2xpYi9nZXQtd29yZC10ZXh0LWFuZC1yYW5nZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbnZhciB7UmFuZ2V9ID0gcmVxdWlyZSgnYXRvbScpO1xuXG4vKipcbiAqIFJldHVybnMgdGhlIHRleHQgYW5kIHJhbmdlIGZvciB0aGUgd29yZCB0aGF0IGNvbnRhaW5zIHRoZSBnaXZlbiBwb3NpdGlvbi5cbiAqL1xuZnVuY3Rpb24gZ2V0V29yZFRleHRBbmRSYW5nZShcbiAgICB0ZXh0RWRpdG9yOiBUZXh0RWRpdG9yLFxuICAgIHBvc2l0aW9uOiBhdG9tJFBvaW50LFxuICAgIHdvcmRSZWdFeHA/OiA/UmVnRXhwKToge3RleHQ6IHN0cmluZzsgcmFuZ2U6IFJhbmdlfSB7XG4gIGlmICghd29yZFJlZ0V4cCkge1xuICAgIHdvcmRSZWdFeHAgPSB0ZXh0RWRpdG9yLmdldExhc3RDdXJzb3IoKS53b3JkUmVnRXhwKCk7XG4gIH1cblxuICB2YXIgdGV4dEFuZFJhbmdlID0ge3RleHQ6ICcnLCByYW5nZTogbmV3IFJhbmdlKHBvc2l0aW9uLCBwb3NpdGlvbil9O1xuICB2YXIgYnVmZmVyID0gdGV4dEVkaXRvci5nZXRCdWZmZXIoKTtcbiAgYnVmZmVyLnNjYW5JblJhbmdlKHdvcmRSZWdFeHAsIGJ1ZmZlci5yYW5nZUZvclJvdyhwb3NpdGlvbi5yb3cpLCBkYXRhID0+IHtcbiAgICBpZiAoZGF0YS5yYW5nZS5jb250YWluc1BvaW50KHBvc2l0aW9uKSkge1xuICAgICAgdGV4dEFuZFJhbmdlID0ge1xuICAgICAgICB0ZXh0OiBkYXRhLm1hdGNoVGV4dCxcbiAgICAgICAgcmFuZ2U6IGRhdGEucmFuZ2UsXG4gICAgICB9O1xuICAgICAgZGF0YS5zdG9wKCk7XG4gICAgfSBlbHNlIGlmIChkYXRhLnJhbmdlLmVuZC5jb2x1bW4gPiBwb3NpdGlvbi5jb2x1bW4pIHtcbiAgICAgIC8vIFN0b3AgdGhlIHNjYW4gaWYgdGhlIHNjYW5uZXIgaGFzIHBhc3NlZCBvdXIgcG9zaXRpb24uXG4gICAgICBkYXRhLnN0b3AoKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB0ZXh0QW5kUmFuZ2U7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0V29yZFRleHRBbmRSYW5nZTtcbiJdfQ==